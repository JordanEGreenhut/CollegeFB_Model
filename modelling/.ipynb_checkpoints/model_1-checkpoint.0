{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "b5b6e279",
   "metadata": {},
   "outputs": [],
   "source": [
    "## import packages often used in College Football modelling\n",
    "%run CFBModel/data_collection_preparation/import_modules.ipynb"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2c50c3cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "## Open college football database\n",
    "## use second half of college football data as test dataset\n",
    "con=sqlite3.connect('CFBModel/collegeFootball.db')\n",
    "cursor_obj= con.cursor()\n",
    "## Get Games2024 data\n",
    "games2024 = pd.read_sql(\"\"\"SELECT * FROM Games2024\"\"\", con)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "862cba8d",
   "metadata": {},
   "outputs": [],
   "source": [
    "### write function to do this parsing\n",
    "## Get games 2020 to 2023 for training data and select 2024 data\n",
    "# Test set is not na values in away_points and before week 9 in 2024\n",
    "\n",
    "games2023=pd.read_sql(\"\"\"SELECT * FROM Games2023\"\"\", con)\n",
    "games2022=pd.read_sql(\"\"\"SELECT * FROM Games2022\"\"\", con)\n",
    "games2021=pd.read_sql(\"\"\"SELECT * FROM Games2021\"\"\", con)\n",
    "games2020=pd.read_sql(\"\"\"SELECT * FROM Games2020\"\"\", con)\n",
    "train_list=[games2024[(~games2024.away_points.isna())&(games2024.week<9)],games2023,games2022,games2021,games2020]\n",
    "df_train=pd.concat(train_list)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "88a7a288",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Test set is na values in away_points and after week 9\n",
    "df_test=games2024[(games2024.away_points.isna())&(games2024.week>=9)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "bbbcd375",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>away_conference</th>\n",
       "      <th>away_division</th>\n",
       "      <th>away_team</th>\n",
       "      <th>highlights</th>\n",
       "      <th>home_conference</th>\n",
       "      <th>home_division</th>\n",
       "      <th>home_team</th>\n",
       "      <th>season_type</th>\n",
       "      <th>start_date</th>\n",
       "      <th>venue</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12481</th>\n",
       "      <td>Conference USA</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Sam Houston</td>\n",
       "      <td>None</td>\n",
       "      <td>Conference USA</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Florida International</td>\n",
       "      <td>regular</td>\n",
       "      <td>2024-10-22T23:30:00.000Z</td>\n",
       "      <td>Pitbull Stadium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12482</th>\n",
       "      <td>Conference USA</td>\n",
       "      <td>fbs</td>\n",
       "      <td>UTEP</td>\n",
       "      <td>None</td>\n",
       "      <td>Conference USA</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Louisiana Tech</td>\n",
       "      <td>regular</td>\n",
       "      <td>2024-10-23T00:00:00.000Z</td>\n",
       "      <td>Joe Aillet Stadium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12483</th>\n",
       "      <td>Conference USA</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Liberty</td>\n",
       "      <td>None</td>\n",
       "      <td>Conference USA</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Kennesaw State</td>\n",
       "      <td>regular</td>\n",
       "      <td>2024-10-23T23:00:00.000Z</td>\n",
       "      <td>Fifth Third Stadium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12484</th>\n",
       "      <td>Conference USA</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Middle Tennessee</td>\n",
       "      <td>None</td>\n",
       "      <td>Conference USA</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Jacksonville State</td>\n",
       "      <td>regular</td>\n",
       "      <td>2024-10-23T23:30:00.000Z</td>\n",
       "      <td>AmFirst Stadium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12485</th>\n",
       "      <td>Sun Belt</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Georgia Southern</td>\n",
       "      <td>None</td>\n",
       "      <td>Sun Belt</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Old Dominion</td>\n",
       "      <td>regular</td>\n",
       "      <td>2024-10-24T23:00:00.000Z</td>\n",
       "      <td>S.B. Ballard Stadium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13865</th>\n",
       "      <td>Conference USA</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Jacksonville State</td>\n",
       "      <td>None</td>\n",
       "      <td>Conference USA</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Western Kentucky</td>\n",
       "      <td>regular</td>\n",
       "      <td>2024-11-30T20:30:00.000Z</td>\n",
       "      <td>Houchens Industries-L.T. Smith Stadium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13866</th>\n",
       "      <td>Mountain West</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Wyoming</td>\n",
       "      <td>None</td>\n",
       "      <td>Pac-12</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Washington State</td>\n",
       "      <td>regular</td>\n",
       "      <td>2024-11-30T23:30:00.000Z</td>\n",
       "      <td>Gesa Field</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13867</th>\n",
       "      <td>Mountain West</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Nevada</td>\n",
       "      <td>None</td>\n",
       "      <td>Mountain West</td>\n",
       "      <td>fbs</td>\n",
       "      <td>UNLV</td>\n",
       "      <td>regular</td>\n",
       "      <td>2024-12-01T01:00:00.000Z</td>\n",
       "      <td>Allegiant Stadium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13868</th>\n",
       "      <td>Mountain West</td>\n",
       "      <td>fbs</td>\n",
       "      <td>New Mexico</td>\n",
       "      <td>None</td>\n",
       "      <td>Mountain West</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Hawai'i</td>\n",
       "      <td>regular</td>\n",
       "      <td>2024-12-01T04:00:00.000Z</td>\n",
       "      <td>Clarence T.C. Ching Athletics Complex</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13869</th>\n",
       "      <td>American Athletic</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Navy</td>\n",
       "      <td>None</td>\n",
       "      <td>American Athletic</td>\n",
       "      <td>fbs</td>\n",
       "      <td>Army</td>\n",
       "      <td>regular</td>\n",
       "      <td>2024-12-14T20:00:00.000Z</td>\n",
       "      <td>Northwest Stadium</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1389 rows Ã— 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         away_conference away_division           away_team highlights  \\\n",
       "12481     Conference USA           fbs         Sam Houston       None   \n",
       "12482     Conference USA           fbs                UTEP       None   \n",
       "12483     Conference USA           fbs             Liberty       None   \n",
       "12484     Conference USA           fbs    Middle Tennessee       None   \n",
       "12485           Sun Belt           fbs    Georgia Southern       None   \n",
       "...                  ...           ...                 ...        ...   \n",
       "13865     Conference USA           fbs  Jacksonville State       None   \n",
       "13866      Mountain West           fbs             Wyoming       None   \n",
       "13867      Mountain West           fbs              Nevada       None   \n",
       "13868      Mountain West           fbs          New Mexico       None   \n",
       "13869  American Athletic           fbs                Navy       None   \n",
       "\n",
       "         home_conference home_division              home_team season_type  \\\n",
       "12481     Conference USA           fbs  Florida International     regular   \n",
       "12482     Conference USA           fbs         Louisiana Tech     regular   \n",
       "12483     Conference USA           fbs         Kennesaw State     regular   \n",
       "12484     Conference USA           fbs     Jacksonville State     regular   \n",
       "12485           Sun Belt           fbs           Old Dominion     regular   \n",
       "...                  ...           ...                    ...         ...   \n",
       "13865     Conference USA           fbs       Western Kentucky     regular   \n",
       "13866             Pac-12           fbs       Washington State     regular   \n",
       "13867      Mountain West           fbs                   UNLV     regular   \n",
       "13868      Mountain West           fbs                Hawai'i     regular   \n",
       "13869  American Athletic           fbs                   Army     regular   \n",
       "\n",
       "                     start_date                                   venue  \n",
       "12481  2024-10-22T23:30:00.000Z                         Pitbull Stadium  \n",
       "12482  2024-10-23T00:00:00.000Z                      Joe Aillet Stadium  \n",
       "12483  2024-10-23T23:00:00.000Z                     Fifth Third Stadium  \n",
       "12484  2024-10-23T23:30:00.000Z                         AmFirst Stadium  \n",
       "12485  2024-10-24T23:00:00.000Z                    S.B. Ballard Stadium  \n",
       "...                         ...                                     ...  \n",
       "13865  2024-11-30T20:30:00.000Z  Houchens Industries-L.T. Smith Stadium  \n",
       "13866  2024-11-30T23:30:00.000Z                              Gesa Field  \n",
       "13867  2024-12-01T01:00:00.000Z                       Allegiant Stadium  \n",
       "13868  2024-12-01T04:00:00.000Z   Clarence T.C. Ching Athletics Complex  \n",
       "13869  2024-12-14T20:00:00.000Z                       Northwest Stadium  \n",
       "\n",
       "[1389 rows x 10 columns]"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_test[df_test.dtypes[df_test.dtypes==object].keys()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "a238f9e8",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\jorda\\AppData\\Local\\Temp\\ipykernel_19592\\3018309407.py:2: UserWarning: Pandas doesn't allow columns to be created via a new attribute name - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access\n",
      "  df_test.away_conf_one_hot= one_hot_away_conf\n"
     ]
    }
   ],
   "source": [
    "one_hot_away_conf = pd.get_dummies(df_test.away_conference)\n",
    "df_test.away_conf_one_hot= one_hot_away_conf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "250d2930",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
